---
type: module
name: 'Sourcing - X'
description: 'Module responsible for generating and uploading X Job Feed.'
product: 'Crossover: Hire'
scripts:
  check:
    - cwd: '.'
      script: 'npm run prettier:check-all'
  test:
    - cwd: 'packages/sourcing-manager'
      script: 'npm run test'
  fix:
    - cwd: '.'
      script: 'npm run prettier:fix-all'
files:
  sources:
    include:
      - 'packages/sourcing-manager/src/**/x*.ts'
  cicd:
    include:
      - 'deploy/src/deployments/sourcing-manager/*.ts'
---

# Context Pack - Crossover: Hire - L2 - Sourcing - X

## Business Context

This module is responsible for generating and uploading a daily feed of X jobs to X, which is a 3rd party job board.
The feed is in XML format and includes basic job information, such as title, description, location, and salary.
The module's main objective is to increase the visibility of Crossover's X jobs to potential candidates and attract more applications.

## Functional Context

The module's key functions include:

- **Fetching X jobs from Salesforce**: The module queries Salesforce to retrieve relevant X job campaigns (defined by their record type).
- **Generating short descriptions**: The module uses a GPT model to generate concise and engaging short descriptions for each job.
- **Constructing XML feed**: The module constructs the XML feed based on the fetched jobs, including their short descriptions.
- **Uploading to S3 bucket**: The module uploads the generated XML feed to a dedicated S3 bucket.

The module is integrated with other modules like:

- **Salesforce Integration**: Retrieves X job data from Salesforce.
- **Feed Upload Service**: Uploads the generated XML feed to S3.

## Important Functional Decisions

- **Short Description Generation:** Utilizing a GPT model for generating short descriptions was chosen for its ability to create concise, engaging, and personalized content tailored to the job specifics. This approach aims to improve the feed's readability and attract potential candidates.
- **Feed Format:** XML was selected as the feed format due to its compatibility with X's requirements and the industry standard for job feeds.

## Technical Context

### Tech Stack

- **Node.js**: The module is implemented in Node.js.
- **Luxon**: Used for date and time formatting.
- **xmlbuilder**: Used to construct the XML feed.
- **Salesforce API**: Used to interact with Salesforce.
- **AWS SDK for JavaScript**: Used for interacting with S3.
- **ChatGPT API**: Used for short description generation.

### Architecture

```mermaid
graph LR
    subgraph Sourcing - X
        A[Job Fetching] --> B[Short Description Generation]
        B --> C[XML Feed Construction]
        C --> D[S3 Upload]
    end
    A --> Salesforce
    B --> ChatGPT API
    D --> S3 Bucket
```

### Data Model

The module primarily utilizes data from Salesforce's X campaigns, which contain fields like job title, description, location, and salary.
Additionally, the module uses a custom interface `Campaign` to include generated short descriptions for each job.

### Important Technical Decisions

- **Asynchronous Operations:** The module leverages asynchronous operations and Promises to optimize performance, particularly for the short description generation process, which is handled in batches.
- **Error Handling:** Robust error handling is implemented to ensure stability and proper logging for potential issues during data retrieval, processing, and uploading.

### 3rd party services

- **Salesforce:** Salesforce is used as the source of truth for X jobs. [Link to Salesforce API Documentation](https://developer.salesforce.com/docs/atlas.en-us.api.meta/api/sforce_api_objects_campaign.htm)
- **X:** X is the target job board where the feed is uploaded. [Link to X Integration Documentation](https://docs.x.com/integration)
- **ChatGPT:** ChatGPT is used as the GPT model for generating short descriptions. [Link to ChatGPT API Documentation](https://platform.openai.com/docs/api-reference/chat)
- **AWS S3:** S3 is used for storing the XML feed. [Link to AWS S3 Documentation](https://aws.amazon.com/s3/)

### 3rd party libraries

- **Salesforce:** This library is used to interact with the Salesforce API.
- **ChatGPT:** This library is used to interact with the ChatGPT API.
- **xmlbuilder:** This library is used to build the XML feed.
- **Luxon:** This library is used for date and time formatting.

## Functions

- **`handler()`**: The main entry point of the module. It orchestrates the entire process of fetching jobs, generating descriptions, constructing the feed, and uploading to S3.
- **`generateXMLFeed()`**: Constructs the XML feed based on the fetched jobs and their short descriptions.
- **`generateShortDescription()`**: Generates a short description for a job using ChatGPT.
- **`getCampaigns()`**: Fetches relevant X campaigns from Salesforce.
- **`getExperienceLevel()`**: Converts LinkedIn experience level values to standardized values used in the XML feed.

The L3 context document for each Function can be found here: [Link to L3 context documents]
